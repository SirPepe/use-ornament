var t=Object.defineProperty,e=t=>{throw TypeError(t)},s=(e,s,r)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,r=(t,e,r)=>s(t,"symbol"!=typeof e?e+"":e,r),a=(t,s,r)=>s.has(t)||e("Cannot "+r),n=(t,e,s)=>(a(t,e,"read from private field"),s?s.call(t):e.get(t)),i=(t,s,r)=>s.has(t)?e("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),o=(t,e,s,r)=>(a(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),l=(t,e,s)=>(a(t,e,"access private method"),s);function h(t){let e=Math.round(Number(t));return Number.isFinite(e)&&!Number.isNaN(e)?e:0}function c(t){return Math.abs(h(t))}var d,u,m,p,f,b,v,y=class t extends HTMLElement{constructor(){super(),i(this,b),r(this,"_shadow",this.attachShadow({mode:"open"})),i(this,d,new CSSStyleSheet),i(this,u,this.attachInternals()),i(this,m,[]),i(this,p,0),i(this,f,null),r(this,"_handleClick",t=>{if("click"===t.type){for(let e of t.composedPath())if(e instanceof HTMLElement){if("next"===e.getAttribute("data-command"))return void this.next();if("prev"===e.getAttribute("data-command"))return void this.prev()}}});let e=t._template();this._shadow.append(...e),this._shadow.addEventListener("click",this._handleClick);let s=this._shadow.querySelector("slot:not([name])");if(!s)throw Error("Template does not contain a default slot");s.addEventListener("slotchange",()=>this._goToCurrent()),this._shadow.adoptedStyleSheets.push(n(this,d))}static _template(){let t=document.createElement("div");return t.innerHTML=`<div part="wrapper">
  <slot></slot>
  <div part="controls-wrapper">
    <slot name="controls">
      <div part="controls">
        <button part="controls-prevBtn" data-command="prev">
          <span>&lt;</span>
        </button>
        <button part="controls-nextBtn" data-command="next">
          <span>&gt;</span>
        </button>
      </div>
    </slot>
  </div>
  <div part="aux-wrapper">
    <slot name="aux"></slot>
  </div>
</div>
<style>
[part="wrapper"] { display: grid; }
:host(:not([controls])) slot[name="controls"] { display: none }
[part="controls"] { position: relative; z-index: 1337; }
</style>`,Array.from(t.children)}static get observedAttributes(){return["keyframes","current"]}attributeChangedCallback(t,e,s){e!==s&&("keyframes"===t?(o(this,m,s?String(s).split(/\s+/).map(c).sort((t,e)=>t-e):[]),l(this,b,v).call(this),this._goToCurrent()):"current"===t&&(o(this,p,this._toKeyframeIdx(s)),this._goToCurrent()))}get controls(){return this.hasAttribute("controls")}set controls(t){t?this.setAttribute("controls","controls"):this.removeAttribute("controls")}get keyframes(){return n(this,m)}set keyframes(t){Array.isArray(t)?(t=Array.from(new Set(t.map(c).sort((t,e)=>t-e))),this.setAttribute("keyframes",t.join(" ")),o(this,m,t)):(this.removeAttribute("keyframes"),o(this,m,[])),l(this,b,v).call(this),this._goToCurrent()}_toKeyframeIdx(t){let e=h(t);return e<0&&(e=Math.abs(e)-1),e>this.maxFrame&&(e=this.maxFrame),n(this,m).indexOf(e)}get current(){return n(this,m)[n(this,p)]||0}set current(t){let e=this._toKeyframeIdx(t);-1!==e?(o(this,p,e),this.setAttribute("current",String(n(this,m)[e]))):(o(this,p,0),this.setAttribute("current","0"))}get nextCurrent(){return n(this,f)&&n(this,m)[n(this,p)]||null}get maxFrame(){return Math.max(...this.keyframes)}_goToCurrent(){let t=n(this,p);t in n(this,m)||(t=n(this,m).length>=1&&t<0?n(this,m).length-1:0),o(this,f,t);let e=this.dispatchEvent(new Event("cm-beforeframechange",{bubbles:!0,cancelable:!0}));return o(this,f,null),!!e&&(this._setClassesAndStates(n(this,m)[t]),t!==n(this,p)&&o(this,p,t),this.dispatchEvent(new Event("cm-afterframechange",{bubbles:!0})),!0)}_setClassesAndStates(t){for(let t of n(this,u).states)/^frame[0-9]+$/.test(t)&&n(this,u).states.delete(t);n(this,u).states.add(`frame${t}`),n(this,u).states.add("hasNext"),n(this,u).states.add("hasPrev"),0===t&&n(this,u).states.delete("hasPrev"),t===n(this,m).at(-1)&&n(this,u).states.delete("hasNext");let e=this._shadow.querySelector("slot:not([name])")?.assignedElements()[0];if(e){for(let t of e.classList)/^frame[0-9]+$/.test(t)&&e.classList.remove(t);e.classList.add(`frame${t}`)}}next(){let t=n(this,p);return o(this,p,n(this,p)+1),this._goToCurrent()?this.current:(o(this,p,t),t)}prev(){let t=n(this,p);return o(this,p,n(this,p)-1),this._goToCurrent()?this.current:(o(this,p,t),t)}go(t){let e=n(this,p);return o(this,p,this._toKeyframeIdx(t)),this._goToCurrent()?this.current:(o(this,p,e),e)}};d=new WeakMap,u=new WeakMap,m=new WeakMap,p=new WeakMap,f=new WeakMap,b=new WeakSet,v=function(){let t='slot[name="aux"]::slotted(*){ display: none }';for(let e of n(this,m))t+=`:host(:state(frame${e})) slot[name="aux"]::slotted(.frame${e}) { display: block; }`;n(this,d).replaceSync(t)},window.customElements.define("code-movie-runtime",y);const x=document.querySelector("code-movie-runtime"),g=document.querySelector("button.next"),w=document.querySelector("button.prev");function S(){w.disabled=0===x.current,g.disabled=x.current===x.maxFrame}for(const t of(g.addEventListener("click",()=>{x.next(),S()}),w.addEventListener("click",()=>{x.prev(),S()}),S(),document.querySelectorAll("table"))){let e=document.createElement("div");e.className="tableScroller",t.replaceWith(e),e.append(t)}const _=document.querySelector(".tutorial  "),k=document.createElement("div");k.className="tutorialScroller",_.replaceWith(k),k.append(_);const A={};for(const t of document.querySelectorAll("h2[id], h3[id], h3[id]")){let e=t.getAttribute("id");t.innerHTML+=`<a href="#${e}">#</a>`;let s=/^@[a-zA-Z]+/.exec(t.innerText);s&&(A[s[0]+"()"]=e)}for(const t of document.querySelectorAll("code:not([class])"))!t.closest("h2, h3, h4")&&A[t.innerText]&&(t.innerHTML=`<a class="ref" title="Jump to documentation for ${t.innerText}" href="#${A[t.innerText]}">${t.innerText}</a>`);